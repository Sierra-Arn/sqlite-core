[workspace]
authors = ["Sierra Arn"]
channels = ["conda-forge"]
name = "sqlite-core"
platforms = ["linux-64"]
version = "0.1.0"

# Create a local environment configuration file by copying .env.example to .env
# After copying, edit .env file to set your specific configuration values
[tasks.copy-env]
cmd = "cp .env.example .env"

# Create a new Alembic migration revision with auto-generated changes
# Detects model changes and generates a new migration script in the migrations directory
# Accepts an optional migration message as the first argument (defaults to "Auto migration")
# Example usage:
# pixi run alembic-revision
# pixi run alembic-revision "Hello, World!"
[tasks.alembic-revision]
args = [
    { arg = "message", default = "Auto migration" }
]
cmd = "alembic -c ./app/migrations/alembic.ini revision --autogenerate -m \"{{ message }}\""

# Apply all pending migrations to bring the database schema up to the latest version
[tasks.alembic-upgrade]
cmd = "alembic -c ./app/migrations/alembic.ini upgrade head"

# Revert the most recent migration to roll back the latest schema change
[tasks.alembic-downgrade]
cmd = "alembic -c ./app/migrations/alembic.ini downgrade -1"

# Open an interactive SQLite database shell
[tasks.sqlite-shell]
depends-on = [
    { task = "_sqlite-shell", environment = "test" }
]

[tasks]

# Internal task â€” do not invoke directly.
# This task exists solely to provide the command implementation for `tasks.sqlite-shell`.
# It relies on the `test` environment where `sqlite3` is installed and `.env` is sourced.
_sqlite-shell = { cmd = "bash -c 'source .env && sqlite3 $SQLITE_DB_PATH'" }

[dependencies]
python = "*"
pydantic-settings = "*"
sqlalchemy = "*"
alembic = "*"
aiosqlite = "*"

[feature.test.dependencies]
ipykernel = "*"
sqlite = "*"

[environments]
test = ["test"]